<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <link rel="icon" type="image/png" href="https://www.pimarkets.io/favicon.ico"/>
    <title>PiMarketsÂ® Votaciones</title>
    <script charset="utf-8"
        src="https://cdn.ethers.io/scripts/ethers-v4.min.js"
        type="text/javascript">
    </script>
    <script type="text/javascript">
        const URL = "https://connect.pichain.io";

        const pnftABI = [{"constant":true,"inputs":[],"name":"name","outputs":[{"name":"_name","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_new","type":"address"}],"name":"setOwner","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"totalSupply","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"address"},{"name":"","type":"bytes32"}],"name":"balances","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_tokenId","type":"bytes32"}],"name":"balanceById","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"tokenOfOwner","outputs":[{"name":"","type":"bytes32[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_index","type":"uint256"}],"name":"tokenOfOwnerByIndex","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"decimals","outputs":[{"name":"","type":"uint8"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"uint256"}],"name":"tokens","outputs":[{"name":"","type":"bytes32"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_destination","type":"address"},{"name":"_tokenId","type":"bytes32"}],"name":"getApproved","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_owner","type":"address"},{"name":"_approved","type":"address"},{"name":"_tokenId","type":"bytes32"},{"name":"_amount","type":"uint256"}],"name":"approve","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_tokenId","type":"bytes32"}],"name":"isExpired","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"}],"name":"balanceOf","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_to","type":"address"},{"name":"_json","type":"uint256[5]"},{"name":"_amount","type":"uint256"}],"name":"mint","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_tokenId","type":"bytes32"},{"name":"_amount","type":"uint256"}],"name":"burn","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_tokenId","type":"bytes32"},{"name":"_amount","type":"uint256"}],"name":"transferFrom","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"owner","outputs":[{"name":"","type":"address"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_new","type":"string"}],"name":"setJsonReference","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[],"name":"symbol","outputs":[{"name":"_symbol","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_operator","type":"address"},{"name":"_approved","type":"bool"}],"name":"setApprovalForAll","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_tokenId","type":"bytes32"}],"name":"getMetadata","outputs":[{"name":"","type":"uint256[5]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"getTokens","outputs":[{"name":"","type":"bytes32[]"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_tokenId","type":"bytes32"},{"name":"_amount","type":"uint256"},{"name":"_data","type":"bytes"}],"name":"safeTransferFromApproved","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":false,"inputs":[{"name":"_from","type":"address"},{"name":"_to","type":"address"},{"name":"_tokenId","type":"bytes32"},{"name":"_amount","type":"uint256"},{"name":"_data","type":"bytes"}],"name":"safeTransferFrom","outputs":[],"payable":false,"stateMutability":"nonpayable","type":"function"},{"constant":true,"inputs":[{"name":"_owner","type":"address"},{"name":"_operator","type":"address"}],"name":"isApprovedForAll","outputs":[{"name":"","type":"bool"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[{"name":"","type":"bytes32"}],"name":"supplyByCategory","outputs":[{"name":"","type":"uint256"}],"payable":false,"stateMutability":"view","type":"function"},{"constant":true,"inputs":[],"name":"jsonReference","outputs":[{"name":"","type":"string"}],"payable":false,"stateMutability":"view","type":"function"},{"inputs":[{"name":"_name","type":"string"},{"name":"_symbol","type":"string"},{"name":"_owner","type":"address"},{"name":"_jsonReference","type":"string"}],"payable":false,"stateMutability":"nonpayable","type":"constructor"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_from","type":"address"},{"indexed":true,"name":"_to","type":"address"},{"indexed":true,"name":"_tokenId","type":"bytes32"},{"indexed":false,"name":"_amount","type":"uint256"}],"name":"Transfer","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_owner","type":"address"},{"indexed":true,"name":"_approved","type":"address"},{"indexed":true,"name":"_tokenId","type":"bytes32"},{"indexed":false,"name":"_amount","type":"uint256"}],"name":"Approval","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"_owner","type":"address"},{"indexed":true,"name":"_operator","type":"address"},{"indexed":false,"name":"_approved","type":"bool"}],"name":"ApprovalForAll","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"tokenId","type":"bytes32"},{"indexed":false,"name":"json","type":"uint256[5]"}],"name":"NewJson","type":"event"},{"anonymous":false,"inputs":[{"indexed":false,"name":"old","type":"string"},{"indexed":false,"name":"current","type":"string"}],"name":"NewJsonReference","type":"event"},{"anonymous":false,"inputs":[{"indexed":true,"name":"old","type":"address"},{"indexed":true,"name":"current","type":"address"}],"name":"NewOwner","type":"event"}];
        const pnftADDRESS = "0xD2b28CC2dE7284A24421AA12f598291eC30c7840";

        const TOKEN_ID = "0x7c2c9e919262fd5b1fc811ba2599e857c67699e3bd4f7fc66f4e4f883e7df674";
        const ACEPTO = "0xc869ee35524228876a8c8ccec4c55cdeeba145f9";
        const NO_ACEPTO = "0xe531941b8a37b6277216275f63717a6fbf17cad3";
        const A = "0xae8259075e77b7c8eb78472a2727fb3fe5b2aed8";
        const B = "0xde40e9c57169b9746e9f37281b40403754a3735b";
        const C = "0xef82df0e1745984b6d078a9440c76b8fdc9e7c65";
        const D = "0xd76b4444f694d6bff1648e75a9afcd33dcd7c6b4";
        const SI = "0xd8d9120a54032c9bcfca124f2c19be54c1c24647";
        const NO = "0x172ba3b2a1b41948093945d05d55280a0f3fa335";
        const TOKEN1 = "0xba9957af63115c4C6cE71890423328D021eA28B5";
        const TOKEN2 = "0xf2C589e0c20ccCEf346aF5DfE93313C544ED0284";
        const TOKEN3 = "0x9f34d11D6257c0500bA25c2745fF2d3E9186712A";
        const TOKEN4 = "0x422DDF7faeF6EAcf7Dd8fd06702E6CBCf9FC50de";
        const TOKEN5 = "0x4bA1cA2132D7e46173ED22cDE79261ADBDa0fB53";
        const TOKEN6 = "0xF214F17818959AF4564434D871bc50c005482e5C";
        const TOKEN7 = "0xF6685B7f3881f829c880Dc9b14e254a2590E21e4";
        const TOKENID1 = "0x83c40760bac449d4ac445b404ba4d4a52f305c08f8ff3770ae88c12e51e46156";
        const TOKENID2 = "0x4ac18e1fbffeb088ada775c0baa6de03400732b1a77fa0517ecb8530465acbde";
        const TOKENID3 = "0xacb99a613af784c1c9b05d5cab31d5c1bf297b106b3a85eda0041309cca0e5bc";
        const TOKENID4 = "0x806f6d4a892bc69efe9f1d41a38cbb39bc1570dfa1a8b47daf1f31478644379c";
        const TOKENID5 = "0xcf652e5146434bcbd08fdeadce47bb1cb94ee418905309894caa9a749c79382f";
        const TOKENID6 = "0x9a1a8449d65491598a9d7cf7938571a592d5751ec686e27e01020ccb50a523ac";
        const TOKENID7 = "0xf1b249376fd4593972e49beed7a6d2cb743860cf49a86e6dfa41d07610075f9b";
        const TOKENSARRAY = [TOKEN1, TOKEN2, TOKEN3, TOKEN4, TOKEN5, TOKEN6, TOKEN7];
        const IDARRAY = [TOKENID1, TOKENID2, TOKENID3, TOKENID4, TOKENID5, TOKENID6, TOKENID7];

        async function getBalanceByIdIndex(_address, _index) {
            let contract = getContractCaller(TOKENSARRAY[_index], pnftABI);
            let _balance = await contract.balanceById(_address, IDARRAY[_index]);
            console.log(_balance / 1e18)
            return _balance;
        }

        async function getBalanceById(_address){
            let contract = getContractCaller(pnftADDRESS, pnftABI);
            let _balance = await contract.balanceById(_address, TOKEN_ID);
            console.log(_balance / 1e18)
            return _balance;
        }

        //updateInfo();
        /*async function updateInfo() {
            document.getElementById("info").innerHTML = "Cargando...";
            let _balanceACEPTO = await getBalanceById(ACEPTO);
            let _balanceNOACEPTO = await getBalanceById(NO_ACEPTO);

            document.getElementById("info").innerHTML = "ACEPTO: " + 
                parseInt(_balanceACEPTO)/1e18  + 
                    " <br> NO ACEPTO: " + parseInt(_balanceNOACEPTO)/1e18;
        }*/

        /*async function updateInfo() {
            document.getElementById("info").innerHTML = "Cargando...";
            let _balanceA = await getBalanceById(A);
            let _balanceB = await getBalanceById(B);
            let _balanceC = await getBalanceById(C);
            let _balanceD = await getBalanceById(D);

            document.getElementById("info").innerHTML = "NBREYES: " + 
                parseInt(_balanceA)/1e18  + 
                " <br> artuve01: " + parseInt(_balanceB)/1e18 +
                " <br> BENJAMINS: " + parseInt(_balanceC)/1e18 +
                " <br> Jhonnygr: " + parseInt(_balanceD)/1e18;
        }*/

        async function updateInfo() {
            document.getElementById("info").innerHTML = "Cargando...";

            let balSI1 = await getBalanceByIdIndex(SI, 0);
            let balNO1 = await getBalanceByIdIndex(NO, 0);
            let balSI2 = await getBalanceByIdIndex(SI, 1);
            let balNO2 = await getBalanceByIdIndex(NO, 1);
            let balSI3 = await getBalanceByIdIndex(SI, 2);
            let balNO3 = await getBalanceByIdIndex(NO, 2);
            let balSI4 = await getBalanceByIdIndex(SI, 3);
            let balNO4 = await getBalanceByIdIndex(NO, 3);
            let balSI5 = await getBalanceByIdIndex(SI, 4);
            let balNO5 = await getBalanceByIdIndex(NO, 4);
            let balSI6 = await getBalanceByIdIndex(SI, 5);
            let balNO6 = await getBalanceByIdIndex(NO, 5);
            let balSI7 = await getBalanceByIdIndex(SI, 6);
            let balNO7 = await getBalanceByIdIndex(NO, 6);

            document.getElementById("info").innerHTML = "Punto 1 (SI): " + 
                parseInt(balSI1)/1e18  + 
                " <br> Punto 1 (NO): " + parseInt(balNO1)/1e18 +
                " <br> Punto 2 (SI): " + parseInt(balSI2)/1e18 +
                " <br> Punto 2 (NO): " + parseInt(balNO2)/1e18 +
                " <br> Punto 3 (SI): " + parseInt(balSI3)/1e18 +
                " <br> Punto 3 (NO): " + parseInt(balNO3)/1e18 +
                " <br> Punto 4 (SI): " + parseInt(balSI4)/1e18 +
                " <br> Punto 4 (NO): " + parseInt(balNO4)/1e18 +
                " <br> Punto 5 (SI): " + parseInt(balSI5)/1e18 +
                " <br> Punto 5 (NO): " + parseInt(balNO5)/1e18 +
                " <br> Punto 6 (SI): " + parseInt(balSI6)/1e18 +
                " <br> Punto 6 (NO): " + parseInt(balNO6)/1e18 +
                " <br> Punto 7 (SI): " + parseInt(balSI7)/1e18 +
                " <br> Punto 7 (NO): " + parseInt(balNO7)/1e18;
        }

        function getContractSigner(address, abi, wallet) {
            wallet = wallet.connect(getProvider());
            return getContractCaller(address, abi).connect(wallet);
        }

        function getContractCaller(address, abi) {
            return new ethers.Contract(address, abi, getProvider());
        }

        function getProvider() {
            return new ethers.providers.JsonRpcProvider(URL);
        }

		function createWalletFromMnemonic(mnemonic, path) {
			return ethers.Wallet.fromMnemonic(mnemonic, path);
		}

		function isValidMnemonic(mnemonic) {
			return ethers.utils.HDNode.isValidMnemonic(mnemonic);
		}

    </script>
    <link href="https://fonts.googleapis.com/css2?family=Open+Sans:wght@400;600&display=swap" rel="stylesheet">
  </head>
  <body>
    <style type='text/css'>
        body {
            font-family: 'Open Sans', sans-serif;
            font-weight: 400;
            background-color: #072146
        }
        
        h1 {
            color: white;
        }

        h2 {
            color: white;
        }

        h3 {
            color: white;
        }

        h4 {
            color: white;
        }

        h5 {
            color: white;
        }

        .mySelector {
            font-family: 'Open Sans', sans-serif;
            font-weight: 400;
            width: 150px;
            font-size: 16px;
            text-align-last:center;
        }

        .myCheckbox {
            font-color: white;
            background-color: green;
        }

        label {
            color:white;
            font-family: 'Open Sans', sans-serif;
        }

        .myButton {
            background-color:#0a93eb;
            border-radius:6px;
            cursor:pointer;
            color:white;
            font-family:Arial;
            font-size:15px;
            font-weight:normal;
            padding:6px 24px;
        }

        .center {
            margin: auto;
            padding: 10px;
            text-align: center;
            justify-content: center;
            align-items: center;
        }
    </style>
    <div class="center">
        <br>
        <br>
        <img src="https://pimarkets.io/assets/img/logo-positive.png" width="250" height="50">
        <h3> -- Recuento 16/03/2021 --</h3>
        <br>
        <button class="myButton" onclick="updateInfo();">Actualizar</button>
        <br>
        <br>
        <div style="color: white;" id="info"></div>
        <br>
        <br>
        
        
    </div>
  </body>
</html>
